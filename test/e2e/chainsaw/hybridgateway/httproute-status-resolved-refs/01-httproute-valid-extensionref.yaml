apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: httproute-with-valid-plugin
  namespace: ($namespace)
spec:
  parentRefs:
    - name: ($gateway_name)
      namespace: ($gateway_namespace)
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /with-plugin
      filters:
        - type: ExtensionRef
          extensionRef:
            group: configuration.konghq.com
            kind: KongPlugin
            name: rate-limit-5-min
      backendRefs:
        - name: ($echo_deployment_name)
          port: 1027
