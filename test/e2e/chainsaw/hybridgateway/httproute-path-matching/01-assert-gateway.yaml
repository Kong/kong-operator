---
# Assert KonnectAPIAuthConfiguration
apiVersion: konnect.konghq.com/v1alpha1
kind: KonnectAPIAuthConfiguration
metadata:
  name: konnect-api-auth-dev-1
  namespace: kong
status:
  conditions:
    - type: APIAuthValid
      status: "True"
---
# Assert GatewayClass with dynamic name
apiVersion: gateway.networking.k8s.io/v1
kind: GatewayClass
metadata:
  name: ($gateway_name)
status:
  conditions:
    - type: Accepted
      status: "True"
---
# Assert GatewayConfiguration with dynamic name (just check existence)
apiVersion: gateway-operator.konghq.com/v2beta1
kind: GatewayConfiguration
metadata:
  name: ($gateway_name)
  namespace: kong
---
# Assert Gateway is ready with dynamic name
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: ($gateway_name)
  namespace: kong
status:
  (conditions[?type == 'Accepted']):
    - status: 'True'
      reason: Accepted
  (conditions[?type == 'Programmed']):
    - status: 'True'
      reason: Programmed
  (conditions[?type == 'DataPlaneReady']):
    - status: 'True'
      reason: Ready
  (conditions[?type == 'KonnectGatewayControlPlaneProgrammed']):
    - status: 'True'
      reason: Programmed
  (conditions[?type == 'KonnectExtensionReady']):
    - status: 'True'
      reason: Ready
  (conditions[?type == 'GatewayService']):
    - status: 'True'
      reason: Ready
---
# Assert KonnectGatewayControlPlane exists
apiVersion: konnect.konghq.com/v1alpha2
kind: KonnectGatewayControlPlane
metadata:
  namespace: kong
  labels:
    gateway-operator.konghq.com/managed-by: gateway
status:
  clusterType: CLUSTER_TYPE_CONTROL_PLANE
  (conditions[?type == 'APIAuthResolvedRef']):
    - status: 'True'
      reason: ResolvedRef
  (conditions[?type == 'APIAuthValid']):
    - status: 'True'
      reason: Valid
  (conditions[?type == 'Programmed']):
    - status: 'True'
      reason: Programmed
  (id != null): true
---
# Assert KonnectExtension exists
apiVersion: konnect.konghq.com/v1alpha2
kind: KonnectExtension
metadata:
  namespace: kong
  labels:
    gateway-operator.konghq.com/managed-by: gateway
status:
  (conditions[?type == 'Ready']):
    - status: 'True'
      reason: Ready
  (conditions[?type == 'APIAuthResolvedRef']):
    - status: 'True'
      reason: ResolvedRef
  (conditions[?type == 'APIAuthValid']):
    - status: 'True'
      reason: Valid
  (conditions[?type == 'ControlPlaneRefValid']):
    - status: 'True'
      reason: Valid
  (conditions[?type == 'DataPlaneCertificateProvisioned']):
    - status: 'True'
      reason: Provisioned
