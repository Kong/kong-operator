kind: KonnectAPIAuthConfiguration
apiVersion: konnect.konghq.com/v1alpha1
metadata:
  name: konnect-api-auth-dev-1
  namespace: default
spec:
  type: token
  token: kpat_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
  serverURL: us.api.konghq.com
---
kind: KonnectGatewayControlPlane
apiVersion: konnect.konghq.com/v1alpha2
metadata:
  name: test1
  namespace: default
spec:
  createControlPlaneRequest:
    name: test1
    labels:
      app: test1
      key1: test1
  konnect:
    authRef:
      name: konnect-api-auth-dev-1
---
# KongReferenceGrant that allows a cluster-scoped KongVault to reference
# the KonnectGatewayControlPlane in the "default" namespace.
apiVersion: configuration.konghq.com/v1alpha1
kind: KongReferenceGrant
metadata:
  name: allow-kongvault-to-konnectgatewaycontrolplane
  namespace: default
spec:
  from:
    - group: configuration.konghq.com
      kind: KongVault
      # KongVault is cluster scoped, so this must be empty.
      namespace: ""
  to:
    - group: konnect.konghq.com
      kind: KonnectGatewayControlPlane
      # Optionally specify a specific KonnectGatewayControlPlane name
      # name: test1
---
kind: KongVault
apiVersion: configuration.konghq.com/v1alpha1
metadata:
  name: env-vault-1
spec:
  backend: env
  prefix: env-vault
  config:
    prefix: "konnect_vault_test_"
  controlPlaneRef:
    type: konnectNamespacedRef
    konnectNamespacedRef:
      name: test1
      # KongVault is cluster scoped, so we need to specify namespace of Konnect control plane.
      namespace: default
